<html>
<head>
    <title>Sign Up</title>
    <link rel="stylesheet" type="text/css" href="css/signup.css">
</head>

<body>
  <form id="workerForm">
    <input type="text" name="username" placeholder="User Name" required>
    <input type="text" name="email" placeholder="Email address" required>
    <input type="password" name='password' placeholder="password" required>
    <input type="password" name='passwordConfirm' placeholder="confirm password" required>
    <button type="submit"> add worker</button>
  </form>
        <a href="login"><button type="button" class="cancelbtn">Cancel</button></a>
        <script type="text/javascript">
        const form = document.querySelector('form');
         form.addEventListener('submit',async (ev)=>{
           ev.preventDefault();
         // do stuff before sending the form data to server
            // check if fields are valid
            const username = document.querySelector('#workerForm input[name="username"]').value;
            const email =  document.querySelector('#workerForm input[name="email"]').value;
            const password =  document.querySelector('#workerForm input[name="password"]').value;
            const passwordConfirm =  document.querySelector('#workerForm input[name="passwordConfirm"]').value;
            
            const res = await fetch('/add-worker',{
              method:'POST',
              headers:{
                'Content-Type':'application/json'
              },
              body:JSON.stringify({username,email,password,passwordConfirm})
            });
            console.log(res.status)
            if( res.status >= 400){
              const body  =  await res.json();
              return alert(body.error);
            }
            
            if( res.status = 200){
              location.href='/';
        //     sessionStorage.setItem('displayName', username);
              return;
            }
            
            
          });
        </script>
</body>
</html>